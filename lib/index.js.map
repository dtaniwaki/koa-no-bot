{"version":3,"sources":["index.coffee"],"names":[],"mappings":"AAAA,IAAA;;AAAA,UAAA,GAAa,SAAC,OAAD;AACX,MAAA;EAAA,MAAqB,OAAA,IAAW,EAAhC,EAAE,WAAA,IAAF,EAAQ,eAAA;EACR,SAAA,OAAS,UAAU,CAAC;EACpB,aAAA,WAAa,SAAC,IAAD,EAAO,EAAP;AACX,QAAA;AAAA,SAAA,sCAAA;;MACE,OAAO,CAAC,GAAR,CAAY,QAAA,GAAS,GAAG,CAAC,IAAb,GAAkB,IAAlB,GAAsB,GAAG,CAAC,MAA1B,GAAiC,IAA7C,EAAkD,EAAlD;AADF;WAEA,IAAC,CAAA,OAAA,CAAD,CAAO,GAAP;EAHW;SAKb,UAAC,IAAD;AACE,QAAA;IAAA,EAAA,GAAK,IAAC,CAAA,GAAD,CAAK,YAAL;IACL,WAAA,GAAc;AACd,SAAA,sCAAA;;MACE,IAAG,EAAE,CAAC,KAAH,CAAS,GAAG,CAAC,MAAb,CAAH;QACE,OAAA,GAAU;QACV,WAAW,CAAC,IAAZ,CAAiB,GAAjB,EAFF;;AADF;IAIA,IAAG,WAAW,CAAC,MAAZ,GAAqB,CAAxB;aACE,QAAQ,CAAC,KAAT,CAAe,IAAf,EAAkB,CAAC,WAAD,EAAc,EAAd,CAAlB,EADF;KAAA,MAAA;aAGE,OAAM,IAAN,EAHF;;EAPF;AARW;;AAoBb,UAAU,CAAC,YAAX,GAA0B;EAAC;IACzB,IAAA,EAAM,cADmB;IAEzB,MAAA,EAAQ,yEAFiB;GAAD;;;AAK1B,MAAM,CAAC,OAAP,GAAiB","file":"index.js","sourceRoot":"/src","sourcesContent":["middleware = (options) ->\n  { bots, callback } = options || {}\n  bots ||= middleware.default_bots\n  callback ||= (bots, ua) ->\n    for bot in bots\n      console.log \"Found #{bot.name} (#{bot.regexp}):\", ua\n    @throw 400\n\n  (next) ->\n    ua = @get(\"user-agent\")\n    matchedBots = []\n    for bot in bots\n      if ua.match(bot.regexp)\n        matched = true\n        matchedBots.push bot\n    if matchedBots.length > 0\n      callback.apply(@, [matchedBots, ua])\n    else\n      yield next\n\nmiddleware.default_bots = [{\n  name: \"General Bots\"\n  regexp: /(bot\\b|spider\\b|crawler\\b|wget|slurp|Mediapartners-Google|YahooSeeker)/i\n}]\n\nmodule.exports = middleware\n"]}